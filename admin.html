<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administración - Ecomundo</title>
    <style>
        :root { --eco-blue: #003366; --white: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; margin: 0; }
        
        .header { background: var(--eco-blue); color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .container { max-width: 800px; margin: 2rem auto; padding: 20px; }
        
        .card { background: white; padding: 2rem; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        h2 { color: var(--eco-blue); border-bottom: 2px solid var(--eco-blue); padding-bottom: 10px; }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .full-width { grid-column: span 2; }
        
        input, select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        
        button { background: var(--eco-blue); color: white; border: none; padding: 12px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; margin-top: 15px; width: 100%; }
        button:hover { background: #002244; }

        .lista-usuarios { margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { text-align: left; padding: 8px; border-bottom: 1px solid #ddd; }
        th { background-color: var(--eco-blue); color: white; }
    </style>
</head>
<body>

    <div class="header">
        <h1>Panel Admin</h1>
        <button onclick="cerrarSesion()" style="width: auto; background: #c0392b;">Cerrar Sesión</button>
    </div>

    <div class="container">
        <div class="card">
            <h2>Crear Nuevo Docente</h2>
            <form id="formCrearUsuario">
                <div class="form-grid">
                    <input type="email" id="email" placeholder="Correo Institucional (@ecomundo.edu.ec)" required class="full-width">
                    <input type="password" id="pass" placeholder="Contraseña Temporal" required>
                    <input type="text" id="area" placeholder="Área (Ej: Matemáticas)" required>
                    <input type="text" id="cursos" placeholder="Cursos (Ej: 1ro, 2do Bach)" required>
                    <input type="text" id="nivel" placeholder="Nivel (Ej: Secundaria)" required>
                    <input type="text" id="materias" placeholder="Materias (Ej: Física, Álgebra)" required class="full-width">
                </div>
                <button type="submit">Registrar Docente</button>
            </form>
        </div>

        <div class="lista-usuarios card">
            <h2>Usuarios Registrados</h2>
            <table id="tablaUsuarios">
                <thead>
                    <tr>
                        <th>Email</th>
                        <th>Área</th>
                        <th>Materias</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>

    <script src="app.js"></script>
    <script>
        // 1. Verificar seguridad (Solo Admin entra aquí)
        verificarSesion('admin');

        // 2. Manejar el formulario
        document.getElementById('formCrearUsuario').addEventListener('submit', (e) => {
            e.preventDefault();
            const nuevoUsuario = {
                email: document.getElementById('email').value,
                pass: document.getElementById('pass').value,
                area: document.getElementById('area').value,
                cursos: document.getElementById('cursos').value,
                nivel: document.getElementById('nivel').value,
                materias: document.getElementById('materias').value,
                rol: 'docente', // Por defecto creamos docentes
                nombre: 'Docente'
            };

            if(crearUsuario(nuevoUsuario)) {
                e.target.reset(); // Limpiar form
                cargarTabla();   // Actualizar lista
            }
        });

        // 3. Cargar tabla visual
        function cargarTabla() {
            const usuarios = JSON.parse(localStorage.getItem('usuarios')) || [];
            const tbody = document.querySelector('#tablaUsuarios tbody');
            tbody.innerHTML = '';
            
            usuarios.forEach(u => {
                if(u.rol !== 'admin') { // Mostrar solo docentes
                    tbody.innerHTML += `<tr><td>${u.email}</td><td>${u.area}</td><td>${u.materias}</td></tr>`;
                }
            });
        }

        function cerrarSesion() {
            localStorage.removeItem('sesionActual');
            window.location.href = 'index.html';
        }

        // Cargar al inicio
        cargarTabla();
    </script>
</body>
</html>